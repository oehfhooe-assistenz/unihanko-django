{% extends "pdf/base.html" %}
{% load i18n %}

{% block header_title %}{{ item.full_identifier }} — {{ item.title }}{% endblock %}

{% block content %}
{% include '_includes/_org_header.html' with org=org %}

<h1 class="document-title">{{ item.full_identifier }}</h1>
<p class="document-subtitle">{{ item.title }}</p>

<div class="section">
    <h2 class="section-title">{% trans "Item Details" %}</h2>
    <div class="section-content">
        <table class="info-table">
            <tr>
                <th>{% trans "Session" %}</th>
                <td>{{ item.session.code }} ({{ item.session.session_date|date:"Y-m-d" }})</td>
            </tr>
            <tr>
                <th>{% trans "Type" %}</th>
                <td>{{ item.get_kind_display }}</td>
            </tr>
            <tr>
                <th>{% trans "Order" %}</th>
                <td>{{ item.order }}</td>
            </tr>
        </table>
    </div>
</div>

{% if item.kind == 'PROC' %}
    <div class="section">
        <h2 class="section-title">{% trans "Content" %}</h2>
        <div class="section-content">
            {{ item.content|linebreaksbr }}
        </div>
    </div>

{% elif item.kind == 'RES' %}
    {% if item.subject %}
    <div class="section">
        <h2 class="section-title">{% trans "Subject" %}</h2>
        <div class="section-content">
            {{ item.subject|safe }}
        </div>
    </div>
    {% endif %}

    {% if item.discussion %}
    <div class="section">
        <h2 class="section-title">{% trans "Discussion" %}</h2>
        <div class="section-content">
            {{ item.discussion|safe }}
        </div>
    </div>
    {% endif %}

    {% if item.voting_mode != 'NONE' %}
    <div class="section">
        <h2 class="section-title">{% trans "Voting Result" %}</h2>
        <div class="section-content">
            <table class="info-table">
                <tr>
                    <th>{% trans "Voting Mode" %}</th>
                    <td>{{ item.get_voting_mode_display }}</td>
                </tr>
                {% if item.voting_mode == 'COUNT' %}
                <tr>
                    <th>{% trans "For" %}</th>
                    <td><strong>{{ item.votes_for }}</strong></td>
                </tr>
                <tr>
                    <th>{% trans "Against" %}</th>
                    <td><strong>{{ item.votes_against }}</strong></td>
                </tr>
                <tr>
                    <th>{% trans "Abstentions" %}</th>
                    <td><strong>{{ item.votes_abstain }}</strong></td>
                </tr>
                {% elif item.voting_mode == 'NAMED' %}
                <tr>
                    <td colspan="2">
                        <table class="data-table" style="margin-top: 0.5rem;">
                            <thead>
                                <tr>
                                    <th>{% trans "Mandate" %}</th>
                                    <th>{% trans "Vote" %}</th>
                                </tr>
                            </thead>
                            <tbody>
                                {% for vote in item.named_votes.all %}
                                <tr>
                                    <td>{{ vote.mandate.person_role.person }}</td>
                                    <td>{{ vote.get_vote_display }}</td>
                                </tr>
                                {% endfor %}
                            </tbody>
                        </table>
                    </td>
                </tr>
                {% endif %}
                <tr>
                    <th>{% trans "Result" %}</th>
                    <td>
                        {% if item.passed %}
                            <span style="color: #27ae60; font-weight: bold;">✓ {% trans "PASSED" %}</span>
                        {% else %}
                            <span style="color: #e74c3c; font-weight: bold;">✗ {% trans "REJECTED" %}</span>
                        {% endif %}
                    </td>
                </tr>
            </table>
        </div>
    </div>
    {% endif %}

    {% if item.outcome %}
    <div class="section">
        <h2 class="section-title">{% trans "Outcome" %}</h2>
        <div class="section-content">
            {{ item.outcome|safe }}
        </div>
    </div>
    {% endif %}

{% elif item.kind == 'ELEC' %}
    {% if item.subject %}
    <div class="section">
        <h2 class="section-title">{% trans "Subject" %}</h2>
        <div class="section-content">
            {{ item.subject|safe }}
        </div>
    </div>
    {% endif %}

    {% if item.elected_person_role %}
    <div class="section">
        <h2 class="section-title">{% trans "Elected Person" %}</h2>
        <div class="section-content">
            <table class="info-table">
                <tr>
                    <th>{% trans "Name" %}</th>
                    <td>{{ item.elected_person_role.person }}</td>
                </tr>
                <tr>
                    <th>{% trans "Role" %}</th>
                    <td>{{ item.elected_person_role.role.name }}</td>
                </tr>
            </table>
        </div>
    </div>
    {% endif %}

    {% if item.voting_mode != 'NONE' %}
    <div class="section">
        <h2 class="section-title">{% trans "Voting Result" %}</h2>
        <div class="section-content">
            <table class="info-table">
                <tr>
                    <th>{% trans "For" %}</th>
                    <td><strong>{{ item.votes_for }}</strong></td>
                </tr>
                <tr>
                    <th>{% trans "Against" %}</th>
                    <td><strong>{{ item.votes_against }}</strong></td>
                </tr>
                <tr>
                    <th>{% trans "Abstentions" %}</th>
                    <td><strong>{{ item.votes_abstain }}</strong></td>
                </tr>
                <tr>
                    <th>{% trans "Result" %}</th>
                    <td>
                        {% if item.passed %}
                            <span style="color: #27ae60; font-weight: bold;">✓ {% trans "ELECTED" %}</span>
                        {% else %}
                            <span style="color: #e74c3c; font-weight: bold;">✗ {% trans "NOT ELECTED" %}</span>
                        {% endif %}
                    </td>
                </tr>
            </table>
        </div>
    </div>
    {% endif %}

    {% if item.outcome %}
    <div class="section">
        <h2 class="section-title">{% trans "Outcome" %}</h2>
        <div class="section-content">
            {{ item.outcome|safe }}
        </div>
    </div>
    {% endif %}
{% endif %}

{% if item.notes %}
<div class="section">
    <h2 class="section-title">{% trans "Notes" %}</h2>
    <div class="section-content">
        <p>{{ item.notes|linebreaksbr }}</p>
    </div>
</div>
{% endif %}

{% include '_includes/_signature_seal.html' with signatures=signatures %}

{% include '_includes/_disclaimer.html' %}

{% endblock %}