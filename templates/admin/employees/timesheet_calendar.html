{% load i18n static %}
<link rel="stylesheet" href="{% static 'employees/timesheet.css' %}">
<div class="ts-card-{{ cal_type }}">
  <div class="ts-head">
    <div class="ts-title">{{ month_label }}</div>
  </div>

  <div class="ts-weekday-row">
    {% for lbl in weekday_labels %}
      <div>{{ lbl }}</div>
    {% endfor %}
  </div>

  <div class="ts-grid">
    {% for c in cells %}
      {% if c.in_month %}
        <div class="ts-cell ts-{{ c.kind_class }}{% if c.is_weekend %} ts-weekend{% endif %}{% if c.is_today %} ts-today{% endif %}">
          <div class="ts-dayhead">
            <span class="ts-daynum">{{ c.date|date:"j" }}</span>
            {% if not c.is_holiday and not c.is_weekend and not is_locked %}
              <a class="ts-add related-widget-wrapper-link"
                data-popup="yes"
                onclick="return showAddAnotherPopup(this);"
                href="{{ add_url_base }}&timesheet={{ timesheet_id }}&date={{ c.date|date:'Y-m-d' }}&_popup=1&next={{ ts_change_url|urlencode }}"
                title="{% trans 'Add entry' %}">+</a>
            {% else %}
              <span class="ts-add ts-add-disabled" title="{% trans 'No entry' %}">—</span>
            {% endif %}
          </div>

          {% if c.items %}
            <ul class="ts-chips">
              {% for it in c.items %}
                <li class="chip k-{{ it.kind|lower }}">
                  <a class="related-widget-wrapper-link"
                     data-popup="yes"
                     onclick="return showAddAnotherPopup(this);"
                     href="{% url 'admin:employees_timeentry_change' it.id %}?_popup=1&next={{ ts_change_url|urlencode }}">
                    <span class="txt">{{ it.kind_display }}{% if it.minutes %} {{ it.minutes }}m{% endif %}</span>
                    {% if it.comment %}<span class="cmt"> — {{ it.comment }}</span>{% endif %}
                  </a>
                </li>
              {% endfor %}
            </ul>
          {% endif %}
        </div>
      {% else %}
        <div class="ts-cell ts-out">
          <span class="ts-daynum">{{ c.date|date:"j" }}</span>
        </div>
      {% endif %}
    {% endfor %}
  </div>

  <div class="ts-legend">
    {% if cal_type == "wrk" %}
    <span class="chip chip-work">{% trans "Work" %}</span>
    <span class="chip chip-other">{% trans "Other" %}</span>
    <span class="chip chip-holiday">{% trans "Holiday" %}</span>
    {% elif cal_type == "pto" %}
    <span class="chip chip-leave">{% trans "Leave" %}</span>
    <span class="chip chip-sick">{% trans "Sick" %}</span>
    <span class="chip chip-holiday">{% trans "Holiday" %}</span>
    {% else %}
    {% endif %}
  </div>
</div>

