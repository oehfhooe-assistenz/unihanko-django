{% extends "pdf/base.html" %}
{% load i18n %}

{% block header_title %}{% trans "Timesheet" %} — {{ ts.employee.person_role.person.last_name }} — {{ ts.year }}-{{ ts.month|stringformat:"02d" }}{% endblock %}

{% block content %}
{% include '_includes/_org_header.html' with org=org %}

<h1 class="document-title">{% trans "Work Journal" %} {{ ts.year }}-{{ ts.month|stringformat:"02d" }}</h1>

{% include '_includes/_person_info_section.html' with person=person %}

<div class="section">
    <h2 class="section-title">{% trans "Employment Details" %}</h2>
    <div class="section-content">
        <table class="info-table">
            <tr>
                <th>{% trans "Role" %}</th>
                <td>{{ role.name }}</td>
            </tr>
            <tr>
                <th>{% trans "Period" %}</th>
                <td>{{ ts.year }}-{{ ts.month|stringformat:"02d" }}</td>
            </tr>
            <tr>
                <th>{% trans "Weekly Hours" %}</th>
                <td>{{ employee.weekly_hours }} h</td>
            </tr>
        </table>
    </div>
</div>

<div class="section">
    <h2 class="section-title">{% trans "Time Summary" %}</h2>
    <div class="section-content">
        <table class="info-table">
            <tr>
                <th>{% trans "Opening Balance" %}</th>
                <td>{{ ts.opening_saldo_minutes }} min</td>
            </tr>
            <tr>
                <th>{% trans "Expected (Month)" %}</th>
                <td>{{ ts.expected_minutes }} min</td>
            </tr>
            <tr>
                <th>{% trans "Worked" %}</th>
                <td>{{ ts.worked_minutes }} min</td>
            </tr>
            <tr>
                <th>{% trans "Credit/Debit" %}</th>
                <td>{{ ts.credit_minutes }} min</td>
            </tr>
            <tr>
                <th>{% trans "Closing Balance" %}</th>
                <td><strong>{{ ts.closing_saldo_minutes }} min</strong></td>
            </tr>
        </table>
    </div>
</div>

<div class="section">
    <h2 class="section-title">{% trans "Leave Summary" %} ({{ leave_year_label }})</h2>
    <div class="section-content">
        <table class="info-table">
            <tr>
                <th>{% trans "Period" %}</th>
                <td>{{ leave_year.period_start|date:"Y-m-d" }} → {{ leave_year.period_end|date:"Y-m-d" }}</td>
            </tr>
            <tr>
                <th>{% trans "Entitlement" %}</th>
                <td>{{ leave_year.entitlement_minutes }} min</td>
            </tr>
            <tr>
                <th>{% trans "Carried Forward" %}</th>
                <td>{{ leave_year.carry_in_minutes }} min</td>
            </tr>
            <tr>
                <th>{% trans "Manual Adjustment" %}</th>
                <td>{{ leave_year.manual_adjust_minutes }} min</td>
            </tr>
            <tr>
                <th>{% trans "Taken" %}</th>
                <td>{{ leave_year.taken_minutes }} min</td>
            </tr>
            <tr>
                <th>{% trans "Remaining" %}</th>
                <td><strong>{{ leave_year.remaining_minutes }} min</strong></td>
            </tr>
        </table>
    </div>
</div>

<div class="section">
    <h2 class="section-title">{% trans "Time Entries" %}</h2>
    <div class="section-content">
        <table class="data-table">
            <thead>
                <tr>
                    <th>{% trans "Date" %}</th>
                    <th>{% trans "Kind" %}</th>
                    <th>{% trans "Start" %}</th>
                    <th>{% trans "End" %}</th>
                    <th>{% trans "Minutes" %}</th>
                    <th>{% trans "Comment" %}</th>
                </tr>
            </thead>
            <tbody>
                {% for entry in entries %}
                <tr>
                    <td>{{ entry.date|date:"Y-m-d" }}</td>
                    <td>{{ entry.get_kind_display }}</td>
                    <td>{% if entry.start_time %}{{ entry.start_time|time:"H:i" }}{% else %}—{% endif %}</td>
                    <td>{% if entry.end_time %}{{ entry.end_time|time:"H:i" }}{% else %}—{% endif %}</td>
                    <td>{{ entry.minutes|default:"—" }}</td>
                    <td>{{ entry.comment|default:"—" }}</td>
                </tr>
                {% empty %}
                <tr>
                    <td colspan="6" class="text-center text-muted">{% trans "No entries" %}</td>
                </tr>
                {% endfor %}
            </tbody>
        </table>
    </div>
</div>

{% include '_includes/_signature_seal.html' with signatures=signatures %}

{% include '_includes/_signature_boxes.html' with count=3 signers=signers %}

{% include '_includes/_disclaimer.html' %}

{% endblock %}