{% load static i18n %}
<!--
Template: base.html
Version: 1.0.0
Author: vas
Modified: 2025-11-27
-->

<!DOCTYPE html>
<html lang="{{ request.LANGUAGE_CODE }}">
<head>
    <meta charset="UTF-8">
    <meta name="viewport" content="width=device-width, initial-scale=1.0">
    <title>{% block title %}{{ page_title }} - UniHanko Portal{% endblock %}</title>
    <link rel="icon" href="{% static 'img/unihanko-logo.svg' %}">
    <link rel="preconnect" href="https://fonts.googleapis.com">
    <link href="https://fonts.googleapis.com/css2?family=Noto+Sans+JP:wght@300;700;900&display=swap" rel="stylesheet">
    <link rel="stylesheet" href="{% static 'portal/portal.css' %}">
    {% block extra_css %}{% endblock %}
</head>
<body class="{% if ENVIRONMENT == 'staging' %}staging-env{% endif %}">
    <header class="portal-header">
        <div class="header-content">
            <span class="hanko-stamp"><img src="{% static 'img/unihanko-logo.svg' %}" alt="UniHanko Logo"></span>
            <a href="{% url 'portal:home' %}" title="{% trans "Self Service Portal" %}" class="logo-animated">
                <span class="logo-static">UNIHANKO</span>
                <span class="logo-expand">
                    <span class="logo-full">.SELF.SERVICE.PORTAL</span>
                    <span class="logo-short">.SSP</span>
                </span>
            </a>
            <nav class="nav-links">
                <a href="/" title="{% trans "Home" %}">{% trans "Home" %}</a>
            </nav>
            
            <!-- Language Switcher -->
            <div class="lang-switcher">
                {% with code=request.LANGUAGE_CODE|slice:":2" %}
                <form method="post" action="{% url 'set_language' %}" style="display: inline;">
                    {% csrf_token %}
                    <input type="hidden" name="next" value="{{ request.path }}">
                    <input type="hidden" name="language" value="en">
                    <button type="submit" class="flag-btn {% if code == 'en' %}active{% endif %}" aria-label="Switch to English">
                        <span class="sr-only">English</span>
                        <svg class="flag" viewBox="0 0 60 40" aria-hidden="true">
                            <rect width="60" height="40" fill="#012169" />
                            <path d="M0,0 60,40 M60,0 0,40" stroke="#fff" stroke-width="8" />
                            <path d="M0,0 60,40 M60,0 0,40" stroke="#C8102E" stroke-width="4" />
                            <rect x="26" width="8" height="40" fill="#fff" />
                            <rect y="16" width="60" height="8" fill="#fff" />
                            <rect x="28" width="4" height="40" fill="#C8102E" />
                            <rect y="18" width="60" height="4" fill="#C8102E" />
                        </svg>
                    </button>
                </form>
                <form method="post" action="{% url 'set_language' %}" style="display: inline;">
                    {% csrf_token %}
                    <input type="hidden" name="next" value="{{ request.path }}">
                    <input type="hidden" name="language" value="de">
                    <button type="submit" class="flag-btn {% if code == 'de' %}active{% endif %}" aria-label="Deutsch (Österreich)">
                        <span class="sr-only">Deutsch</span>
                        <svg class="flag" viewBox="0 0 3 2" aria-hidden="true">
                            <rect width="3" height="2" fill="#ED2939" />
                            <rect y="0.6667" width="3" height="0.6667" fill="#FFFFFF" />
                        </svg>
                    </button>
                </form>
                {% endwith %}
            </div>

        </div>
    </header>

    <main class="portal-container">
        {% if messages %}
        <div class="messages">
            {% for message in messages %}
            <div class="message {{ message.tags }}">
                {{ message }}
            </div>
            {% endfor %}
        </div>
        {% endif %}

        {% block content %}{% endblock %}
    </main>

    <footer class="portal-footer">
        <div class="credits">
        {% trans "Built with" %} <span class="heart">♥</span> {% trans "by" %} 
        <a href="https://github.com/yourusername" target="_blank">Sven Várszegi</a>
        {% trans "for the" %} <a href="https://www.oeh.fh-ooe.at" target="_blank" rel="noopener" style="text-decoration: none; border-bottom: none !important; align-items: center;"><img src="{% static 'img/unihanko-mark.svg' %}" alt="UniHanko Logo" width="40px" height="40px" style="vertical-align:middle; margin: 0 4px;"></a></span>
        <span><small style="margin-top: 0.1rem; display: block;">© 2025 {% trans "All rights reserved" %} UH:SSP {{ UNIHANKO_VERSION_FULL }}</small></span>
        </div>
    </footer>

    {% block extra_js %}
    <script>
    setTimeout(() => {
        const logo = document.querySelector('.logo-animated');
        if (logo) logo.classList.add('should-collapse');
    }, 3000);
    </script>
    {% endblock %}
</body>
</html>